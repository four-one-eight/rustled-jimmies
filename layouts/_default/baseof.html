<!DOCTYPE html>
<html lang="{{ with .Site.LanguageCode }}{{ . }}{{ else }}en-US{{ end }}">
<head>
  {{ .Hugo.Generator }}
  <meta charset="utf-8" />
  <base href="{{ .Site.BaseURL }}">
  <!-- Variable Title. Will display current comic name as site title. -->
  <title>
    {{ $url := replace .Permalink ( printf "%s" .Site.BaseURL) "" }}
    {{ if eq $url "/" }}
      {{ .Site.Title }}
    {{ else }}
      {{ if .Params.heading }}
        {{ .Params.heading }}
      {{ else }}
        {{ .Title }}
      {{ end }}
    {{ end }}
  </title>
  <meta name="author" content="{{ .Site.Author.name }}" />
  <meta name="description" content="{{ .Site.Params.meta.description }}" />
  <meta name="keywords" content="{{ .Site.Params.meta.keywords }}" />
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,initial-scale=1.0,maximum-scale=5.0,viewport-fit=cover">
  <meta name="theme-color" content="#70B4D6">

  <!-- RSS -->
  {{ with .OutputFormats.Get "rss" -}}
      {{ printf `<link rel="%s" type="%s+%s" href="%s" title="%s" />` .Rel .MediaType.Type .MediaType.Suffix .Permalink $.Site.Title | safeHTML }}
  {{ end -}}

  <!-- Open Graph -->
  <link rel="canonical" href="{{ .Permalink }}">
  {{ if .RSSLink }}
  <link href="{{ .RSSLink }}" rel="feed" type="application/rss+xml" title="{{ .Site.Title }}"/>
  {{ end }}
  <base href="{{ .Site.BaseURL }}" />
  {{ template "_internal/twitter_cards.html" . }}
  <meta name="twitter:image" content="{{ .Site.BaseURL }}/icons/avatar.png" />
  {{ template "_internal/opengraph.html" . }}
  <meta property="og:image" content="{{ .Site.BaseURL }}/icons/avatar.png" />
  {{ template "_internal/schema.html" . }}

  <!-- Fonts -->  
  <link rel="preload" href={{ "fonts/Sam-subset.woff2" | relURL }} as="font" type="font/woff2" crossorigin>
  <link rel="preload" href={{ "fonts/Sam-subset.woff" | relURL }} as="font" type="font/woff" crossorigin>

  <!-- Critical -->
  {{ partial "critical.html" . }}

  <!-- Critical Font Loading -->
  <script>
      (function() {
        "use strict";
        // Optimization for Repeat Views
        if( sessionStorage.fontsLoadedCriticalFoftPreloadFallback ) {
          document.documentElement.className += " fonts-loaded-2";
          return;
        } else if( "fonts" in document ) {
          document.fonts.load("1em Sam Subset").then(function () {
            document.documentElement.className += " fonts-loaded-1";
            Promise.all([
              document.fonts.load("400 1em Sam")
            ]).then(function () {
              document.documentElement.className += " fonts-loaded-2";
              // Optimization for Repeat Views
              sessionStorage.fontsLoadedCriticalFoftPreloadFallback = true;
            });
          });
        } else {
          // use fallback
          var ref = document.getElementsByTagName( "script" )[ 0 ];
          var script = document.createElement( "script" );
          script.src = "{{ "js/critical-fallback.js" | relURL }}";
          script.async = true;
          ref.parentNode.insertBefore( script, ref );
        }
      })();
      </script>

  <!-- Stylesheets -->
  {{ $styles := resources.Get "css/main.scss" | toCSS | postCSS | minify }}
  <link rel="stylesheet" href="{{ $styles.Permalink }}" media="screen">

  <!-- Graphic Assets -->
  <link rel="shortcut icon" href={{ "/icons/favicon.png" | relURL }}>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="{{ .Site.Title }}">
  <link rel="apple-touch-icon" sizes="152x152" href={{ "/icons/apple-touch-icon-152x152.png" | relURL }}>
  <link rel="apple-touch-icon" sizes="167x167" href={{ "/icons/apple-touch-icon-167x167.png" | relURL }}>
  <link rel="apple-touch-icon" sizes="180x180" href={{ "/icons/apple-touch-icon-180x180.png" | relURL }}>
  <link rel="mask-icon" color="#70B4D6" href={{ "/icons/safari-pinned-tab.svg" | relURL }}>

  <!-- Android Chrome Icon -->
  <link rel="android-chrome" sizes="128x128" href="{{ "icons/icons/android-chrome-128x128.png" | relURL }}">
  <link rel="android-chrome" sizes="192x192" href="{{ "icons/icons/android-chrome-192x192.png" | relURL }}">
  <link rel="android-chrome" sizes="512x512" href="{{ "icons/icons/android-chrome-512x512.png" | relURL }}">
  
  <!-- Analytics -->
  <script>
    (function (i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
      (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date(); a = s.createElement(o),
      m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
    ga('create', '{{ .Site.Params.google.analytics.trackerID }}', 'auto');
    ga('send', 'pageview');
  </script>
  
  <!-- AdSense -->
  <!-- <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "{{ .Site.Params.google.adsense.adClient }}",
      enable_page_level_ads: true
    });
  </script> -->
</head>
<body>
  <!-- Main content -->
  {{ block "main" . }}
  {{ end }}

  <!-- Scripts -->
  {{ partial "scripts.html" . }}
</body>
</html>